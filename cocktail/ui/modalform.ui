<?xml version="1.0" encoding="utf-8"?>

<ui:cocktail.ui.Modal
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://www.whads.com/ns/cocktail/ui">

    <?class
    getActions() {
        return new cocktail.ui.ActionSet("modal-form-actions", {
            entries: [
                new cls.AcceptAction("accept"),
                new cls.CancelAction("cancel")
            ]
        });
    }

    accept() {
        cocktail.ui.trigger(
            this,
            "accepted",
            {value: this.form.value}
        );
        this.close();
    }

    cancel() {
        cocktail.ui.trigger(this, "canceled");
        this.close();
    }
    ?>

    <?tail
    cls.AcceptAction = class AcceptAction extends cocktail.ui.Action {

        getIconURL(context) {
            return "cocktail.ui://images/accept.svg";
        }

        get translationPrefix() {
            return cls.fullName + ".actions";
        }

        invoke(context) {
            context.modal.close();
        }
    }

    cls.AcceptAction = class AcceptAction extends cocktail.ui.Action {

        getIconURL(context) {
            return "cocktail.ui://images/accept.svg";
        }

        get translationPrefix() {
            return cls.fullName + ".actions";
        }

        invoke(context) {
            context.modal.accept();
        }
    }

    cls.CancelAction = class AcceptAction extends cocktail.ui.Action {

        getIconURL(context) {
            return "cocktail.ui://images/close.svg";
        }

        get translationPrefix() {
            return cls.fullName + ".actions";
        }

        invoke(context) {
            context.modal.cancel();
        }
    }
    ?>

    <ui:with ui:element="content">

        <ui:cocktail.ui.Form
            id="form"
            formLayout="verticalTable">

            <?on keydown
            if (e.which == cocktail.ui.keys.ENTER) {
                instance.accept();
                e.stopPropagation();
                e.preventDefault();
            }
            ?>

        </ui:cocktail.ui.Form>

    </ui:with>

</ui:cocktail.ui.Modal>

